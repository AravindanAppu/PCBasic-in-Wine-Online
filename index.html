<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>DOSBox-X WASM + GW-BASIC</title>
  <style>
    body { margin:0; background:#111; color:#eee; text-align:center; }
    canvas { width:800px; height:600px; border:2px solid #444; margin:20px auto; display:block; }
  </style>
</head>
<body>
  <h2>DOSBox-X WASM (GW-BASIC Auto-Boot)</h2>
  <canvas id="dosbox"></canvas>

  <script>
    var Module = {
      canvas: document.getElementById("dosbox"),
      print: (t)=>console.log("[stdout]", t),
      printErr: (t)=>console.error("[stderr]", t),
      onRuntimeInitialized: async function() {
        console.log("DOSBox-X runtime ready");

        // Fetch gwbasic.zip hosted alongside index.html
        const resp = await fetch("basic.zip");
        const buf  = await resp.arrayBuffer();
        const data = new Uint8Array(buf);

        // Write zip file into Emscripten filesystem
        FS.writeFile("/basic.zip", data);

        // Mount ZIP as drive C:
        Module.callMain([
          "-c", "mount z .",
          "-c", "z:",
          "-c", "imgmount c /basic.zip -t iso",
          "-c", "c:",
          "-c", "dir",
          "-c", "gwbasic.exe"
        ]);
      }
    };
  </script>

  <!-- Load your wasm/JS build -->
  <script src="./main.js"></script>
</body>
</html>
