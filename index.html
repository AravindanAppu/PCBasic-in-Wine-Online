<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>gwbasic</title>

    <style>
        html, body {
            height: 100%;
        }

        #dos {
            width: 100%;
            height: 100%;
        }
    </style>

    <!-- js-dos style sheet -->
    <link rel="stylesheet" href="https://v8.js-dos.com/latest/js-dos.css">

    <!-- js-dos -->
    <script src="https://v8.js-dos.com/latest/js-dos.js"></script>
</head>
<body>

    <div id="dos" style="width: 100%; height: 100%"></div>

    <script>
function deleteJSDOSDatabase(dbName = "aravindanappu.github.io") {
    if (!window.indexedDB) {
        console.error("IndexedDB is not supported in this browser.");
        return;
    }

    const deleteRequest = indexedDB.deleteDatabase(dbName);

    deleteRequest.onerror = function(event) {
        console.error("Error deleting database:", event);
    };

    deleteRequest.onsuccess = function(event) {
        console.log(`Database '${dbName}' deleted successfully.`);
    };

    deleteRequest.onblocked = function() {
        console.warn(`Delete blocked. Please close other tabs using '${dbName}'.`);
    };
}

// Call it with the correct database name:
deleteJSDOSDatabase("aravindanappu.github.io");
// or "js-dos-v2" depending on what you find in your browser.

const props = Dos(document.getElementById("dos"), {
  url: "./basic.jsdos",
  dosboxConf: "./dosbox.conf",
  backend: "dosboxX",
  backendLocked: true,
  autoSave: false,
  kiosk: true,
      onEvent: (event, ci) => {
        if (event === "ci-ready") {
          console.log("Emulator ready. GW-BASIC should be running.");

          // Periodically check if 'output.txt' exists
          const interval = setInterval(() => {
            ci.fsReadFile("output.txt")
              .then(data => {
                console.log("output.txt found! Stopping emulator...");
                clearInterval(interval); // Stop checking
                props.stop(); // Stop emulator
              })
              .catch(err => {
                // File not found yet, keep waiting
              });
          }, 1000); // Check every 1 second
        }
      },
});
    </script>
</body>
</html>




























